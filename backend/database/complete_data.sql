
USE isler_kitabevi;


DELETE FROM sales;
DELETE FROM expenses;


INSERT INTO sales (branch_id, date, category, quantity, revenue)
SELECT 
    b.id,
    DATE(CONCAT('2024-', LPAD(m.m, 2, '0'), '-15')),
    c.cat,
    FLOOR(100 + RAND() * 200 * CASE b.id 
        WHEN 1 THEN 1.5 WHEN 2 THEN 1.6 WHEN 3 THEN 1.4 
        WHEN 4 THEN 1.1 WHEN 5 THEN 1.3 WHEN 6 THEN 0.9 
        WHEN 7 THEN 1.0 WHEN 8 THEN 0.8 WHEN 9 THEN 0.85 
        WHEN 10 THEN 0.6 WHEN 11 THEN 0.75 WHEN 12 THEN 0.5 
        ELSE 1 END),
    ROUND((100 + RAND() * 200) * (25 + RAND() * 15) * CASE b.id 
        WHEN 1 THEN 1.5 WHEN 2 THEN 1.6 WHEN 3 THEN 1.4 
        WHEN 4 THEN 1.1 WHEN 5 THEN 1.3 WHEN 6 THEN 0.9 
        WHEN 7 THEN 1.0 WHEN 8 THEN 0.8 WHEN 9 THEN 0.85 
        WHEN 10 THEN 0.6 WHEN 11 THEN 0.75 WHEN 12 THEN 0.5 
        ELSE 1 END, 2)
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
CROSS JOIN (SELECT 'Books' cat UNION SELECT 'Stationery' UNION SELECT 'Kids' UNION SELECT 'Gifts' UNION SELECT 'OnlineOrders') c
WHERE b.status = 'Active';


INSERT INTO sales (branch_id, date, category, quantity, revenue)
SELECT 
    b.id,
    DATE(CONCAT('2025-', LPAD(m.m, 2, '0'), '-15')),
    c.cat,
    FLOOR(110 + RAND() * 220 * CASE b.id 
        WHEN 1 THEN 1.5 WHEN 2 THEN 1.6 WHEN 3 THEN 1.4 
        WHEN 4 THEN 1.1 WHEN 5 THEN 1.3 WHEN 6 THEN 0.9 
        WHEN 7 THEN 1.0 WHEN 8 THEN 0.8 WHEN 9 THEN 0.85 
        WHEN 10 THEN 0.6 WHEN 11 THEN 0.75 WHEN 12 THEN 0.5 
        ELSE 1 END),
    ROUND((110 + RAND() * 220) * (27 + RAND() * 17) * CASE b.id 
        WHEN 1 THEN 1.5 WHEN 2 THEN 1.6 WHEN 3 THEN 1.4 
        WHEN 4 THEN 1.1 WHEN 5 THEN 1.3 WHEN 6 THEN 0.9 
        WHEN 7 THEN 1.0 WHEN 8 THEN 0.8 WHEN 9 THEN 0.85 
        WHEN 10 THEN 0.6 WHEN 11 THEN 0.75 WHEN 12 THEN 0.5 
        ELSE 1 END, 2)
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11) m
CROSS JOIN (SELECT 'Books' cat UNION SELECT 'Stationery' UNION SELECT 'Kids' UNION SELECT 'Gifts' UNION SELECT 'OnlineOrders') c
WHERE b.status = 'Active';


INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2024-', LPAD(m.m, 2, '0'), '-01')), 'Rent',
    CASE b.id WHEN 1 THEN 28000 WHEN 2 THEN 32000 WHEN 3 THEN 25000 WHEN 4 THEN 20000 WHEN 5 THEN 22000 WHEN 6 THEN 17000 WHEN 7 THEN 18000 WHEN 8 THEN 14000 WHEN 9 THEN 16000 WHEN 10 THEN 25000 WHEN 11 THEN 15000 WHEN 12 THEN 22000 ELSE 15000 END
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
WHERE b.status = 'Active';


INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2024-', LPAD(m.m, 2, '0'), '-01')), 'Salary',
    CASE b.id WHEN 1 THEN 50000 WHEN 2 THEN 55000 WHEN 3 THEN 45000 WHEN 4 THEN 36000 WHEN 5 THEN 42000 WHEN 6 THEN 32000 WHEN 7 THEN 34000 WHEN 8 THEN 28000 WHEN 9 THEN 30000 WHEN 10 THEN 50000 WHEN 11 THEN 29000 WHEN 12 THEN 48000 ELSE 30000 END
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
WHERE b.status = 'Active';

INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2024-', LPAD(m.m, 2, '0'), '-01')), 'Utilities', 3500 + RAND() * 2500
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
WHERE b.status = 'Active';


INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2025-', LPAD(m.m, 2, '0'), '-01')), 'Rent',
    CASE b.id WHEN 1 THEN 30000 WHEN 2 THEN 35000 WHEN 3 THEN 27000 WHEN 4 THEN 22000 WHEN 5 THEN 24000 WHEN 6 THEN 19000 WHEN 7 THEN 20000 WHEN 8 THEN 16000 WHEN 9 THEN 18000 WHEN 10 THEN 28000 WHEN 11 THEN 17000 WHEN 12 THEN 25000 ELSE 17000 END
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11) m
WHERE b.status = 'Active';


INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2025-', LPAD(m.m, 2, '0'), '-01')), 'Salary',
    CASE b.id WHEN 1 THEN 55000 WHEN 2 THEN 60000 WHEN 3 THEN 50000 WHEN 4 THEN 40000 WHEN 5 THEN 46000 WHEN 6 THEN 35000 WHEN 7 THEN 37000 WHEN 8 THEN 31000 WHEN 9 THEN 33000 WHEN 10 THEN 55000 WHEN 11 THEN 32000 WHEN 12 THEN 52000 ELSE 33000 END
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11) m
WHERE b.status = 'Active';


INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2025-', LPAD(m.m, 2, '0'), '-01')), 'Utilities', 4000 + RAND() * 3000
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11) m
WHERE b.status = 'Active';


UPDATE expenses SET amount = amount * 2 WHERE branch_id IN (10, 12);


SELECT 'Veriler olu≈üturuldu!' as Mesaj;
SELECT YEAR(date) as Yil, COUNT(*) as Satis FROM sales GROUP BY YEAR(date);
SELECT YEAR(date) as Yil, COUNT(*) as Gider FROM expenses GROUP BY YEAR(date);
