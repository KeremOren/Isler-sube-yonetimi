
USE isler_kitabevi;


DELETE FROM sales;
DELETE FROM expenses;




INSERT INTO sales (branch_id, date, category, quantity, revenue)
SELECT b.id, DATE(CONCAT('2023-', LPAD(m.m, 2, '0'), '-01')), c.cat,
    FLOOR(500 + RAND() * 500 * mult.mult),
    ROUND((500 + RAND() * 500 * mult.mult) * (20 + RAND() * 20), 2)
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
CROSS JOIN (SELECT 'Books' cat UNION SELECT 'Stationery' UNION SELECT 'Kids' UNION SELECT 'Gifts' UNION SELECT 'OnlineOrders') c
JOIN (SELECT 1 id, 1.3 mult UNION SELECT 2, 1.4 UNION SELECT 3, 1.2 UNION SELECT 4, 0.9 UNION SELECT 5, 1.1 UNION SELECT 6, 0.8 UNION SELECT 7, 0.95 UNION SELECT 8, 0.7 UNION SELECT 9, 0.85 UNION SELECT 10, 0.6 UNION SELECT 11, 0.75 UNION SELECT 12, 0.5) mult ON b.id = mult.id;


INSERT INTO sales (branch_id, date, category, quantity, revenue)
SELECT b.id, DATE(CONCAT('2024-', LPAD(m.m, 2, '0'), '-01')), c.cat,
    FLOOR(550 + RAND() * 550 * mult.mult),
    ROUND((550 + RAND() * 550 * mult.mult) * (22 + RAND() * 22), 2)
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
CROSS JOIN (SELECT 'Books' cat UNION SELECT 'Stationery' UNION SELECT 'Kids' UNION SELECT 'Gifts' UNION SELECT 'OnlineOrders') c
JOIN (SELECT 1 id, 1.3 mult UNION SELECT 2, 1.4 UNION SELECT 3, 1.2 UNION SELECT 4, 0.9 UNION SELECT 5, 1.1 UNION SELECT 6, 0.8 UNION SELECT 7, 0.95 UNION SELECT 8, 0.7 UNION SELECT 9, 0.85 UNION SELECT 10, 0.6 UNION SELECT 11, 0.75 UNION SELECT 12, 0.5) mult ON b.id = mult.id;


INSERT INTO sales (branch_id, date, category, quantity, revenue)
SELECT b.id, DATE(CONCAT('2025-', LPAD(m.m, 2, '0'), '-01')), c.cat,
    FLOOR(600 + RAND() * 600 * mult.mult),
    ROUND((600 + RAND() * 600 * mult.mult) * (24 + RAND() * 24), 2)
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
CROSS JOIN (SELECT 'Books' cat UNION SELECT 'Stationery' UNION SELECT 'Kids' UNION SELECT 'Gifts' UNION SELECT 'OnlineOrders') c
JOIN (SELECT 1 id, 1.3 mult UNION SELECT 2, 1.4 UNION SELECT 3, 1.2 UNION SELECT 4, 0.9 UNION SELECT 5, 1.1 UNION SELECT 6, 0.8 UNION SELECT 7, 0.95 UNION SELECT 8, 0.7 UNION SELECT 9, 0.85 UNION SELECT 10, 0.6 UNION SELECT 11, 0.75 UNION SELECT 12, 0.5) mult ON b.id = mult.id;


INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2023-', LPAD(m.m, 2, '0'), '-01')), 'Rent', rent.rent
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
JOIN (SELECT 1 id, 25000 rent UNION SELECT 2, 30000 UNION SELECT 3, 22000 UNION SELECT 4, 18000 UNION SELECT 5, 20000 UNION SELECT 6, 15000 UNION SELECT 7, 16000 UNION SELECT 8, 12000 UNION SELECT 9, 14000 UNION SELECT 10, 11000 UNION SELECT 11, 13000 UNION SELECT 12, 10000) rent ON b.id = rent.id;

INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2023-', LPAD(m.m, 2, '0'), '-01')), 'Salary', sal.sal
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
JOIN (SELECT 1 id, 45000 sal UNION SELECT 2, 50000 UNION SELECT 3, 40000 UNION SELECT 4, 32000 UNION SELECT 5, 38000 UNION SELECT 6, 28000 UNION SELECT 7, 30000 UNION SELECT 8, 25000 UNION SELECT 9, 27000 UNION SELECT 10, 22000 UNION SELECT 11, 26000 UNION SELECT 12, 20000) sal ON b.id = sal.id;

INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2023-', LPAD(m.m, 2, '0'), '-01')), 'Utilities', 3000 + RAND() * 2000
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m;


INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2024-', LPAD(m.m, 2, '0'), '-01')), 'Rent', ROUND(rent.rent * 1.1, 2)
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
JOIN (SELECT 1 id, 25000 rent UNION SELECT 2, 30000 UNION SELECT 3, 22000 UNION SELECT 4, 18000 UNION SELECT 5, 20000 UNION SELECT 6, 15000 UNION SELECT 7, 16000 UNION SELECT 8, 12000 UNION SELECT 9, 14000 UNION SELECT 10, 11000 UNION SELECT 11, 13000 UNION SELECT 12, 10000) rent ON b.id = rent.id;

INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2024-', LPAD(m.m, 2, '0'), '-01')), 'Salary', ROUND(sal.sal * 1.15, 2)
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
JOIN (SELECT 1 id, 45000 sal UNION SELECT 2, 50000 UNION SELECT 3, 40000 UNION SELECT 4, 32000 UNION SELECT 5, 38000 UNION SELECT 6, 28000 UNION SELECT 7, 30000 UNION SELECT 8, 25000 UNION SELECT 9, 27000 UNION SELECT 10, 22000 UNION SELECT 11, 26000 UNION SELECT 12, 20000) sal ON b.id = sal.id;

INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2024-', LPAD(m.m, 2, '0'), '-01')), 'Utilities', 3300 + RAND() * 2200
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m;


INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2025-', LPAD(m.m, 2, '0'), '-01')), 'Rent', ROUND(rent.rent * 1.2, 2)
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
JOIN (SELECT 1 id, 25000 rent UNION SELECT 2, 30000 UNION SELECT 3, 22000 UNION SELECT 4, 18000 UNION SELECT 5, 20000 UNION SELECT 6, 15000 UNION SELECT 7, 16000 UNION SELECT 8, 12000 UNION SELECT 9, 14000 UNION SELECT 10, 11000 UNION SELECT 11, 13000 UNION SELECT 12, 10000) rent ON b.id = rent.id;

INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2025-', LPAD(m.m, 2, '0'), '-01')), 'Salary', ROUND(sal.sal * 1.25, 2)
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m
JOIN (SELECT 1 id, 45000 sal UNION SELECT 2, 50000 UNION SELECT 3, 40000 UNION SELECT 4, 32000 UNION SELECT 5, 38000 UNION SELECT 6, 28000 UNION SELECT 7, 30000 UNION SELECT 8, 25000 UNION SELECT 9, 27000 UNION SELECT 10, 22000 UNION SELECT 11, 26000 UNION SELECT 12, 20000) sal ON b.id = sal.id;

INSERT INTO expenses (branch_id, date, expense_type, amount)
SELECT b.id, DATE(CONCAT('2025-', LPAD(m.m, 2, '0'), '-01')), 'Utilities', 3600 + RAND() * 2400
FROM branches b
CROSS JOIN (SELECT 1 m UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9 UNION SELECT 10 UNION SELECT 11 UNION SELECT 12) m;


SELECT 'Veriler olu≈üturuldu!' as Mesaj;
SELECT YEAR(date) as Yil, COUNT(*) as Satis_Kayit FROM sales GROUP BY YEAR(date);
SELECT YEAR(date) as Yil, COUNT(*) as Gider_Kayit FROM expenses GROUP BY YEAR(date);
